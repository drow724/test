<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
  </head>
  <body>
    <script src="/lib/jquery.js"></script>
    <script src="/lib/support.js"></script>
    <li>
        <input
          type="number"
          name="faceamount"
          placeholder="금액을 입력해주세요."
        />
        <input type="number" name="result" placeholder="결과" readonly/>
      </li>
      <li>
        <input
          type="number"
          name="faceamount"
          placeholder="금액을 입력해주세요."
        />
        <input type="number" name="result" placeholder="결과" readonly/>
      </li>
      <li>
        <input
          type="number"
          name="faceamount"
          placeholder="금액을 입력해주세요."
        />
        <input type="number" name="result" placeholder="결과" readonly />
      </li>
      <li>
        <input
          type="number"
          name="faceamount"
          placeholder="금액을 입력해주세요."
        />
        <input type="number" name="result" placeholder="결과" readonly/>
      </li>
      <li>
        <input
          type="number"
          name="faceamount"
          placeholder="금액을 입력해주세요."
        />
        <input type="number" name="result" placeholder="결과" readonly/>
      </li>
      <li>
        <input
          type="number"
          name="faceamount"
          placeholder="금액을 입력해주세요."
        />
        <input type="number" name="result" placeholder="결과" readonly/>
      </li>
    </ul>
    <button id="load">랜덤 불러오기</button>
  </body>
  <script>
    /**
     * 1 -> 2 순서대로 문제를 해결해 주세요!
     * 참고: calculate 함수는 api호출을 하는데 (실제로 X) 소요 시간이 랜덤이다.
     * 1. errorValid 함수를 실행하여 전체 합계가 350이 넘을경우 빨간색으로 색칠한다. (errorValid함수 안에 빨간색으로 색칠하는 함수가 있기 때문에 구현 X)
     * 2. 전체 calculate함수 실행 후 마지막에 errorValid함수를 한번만 실행한다.
     */ 
    $(function () {
      const $faceamount = $(`[name="faceamount"]`);

      const cal = async (event) => {
        const target = event.target;

        if (!$(target).val()) {
          return;
        }

        const result = await calculate($(target).val());
        $(target).next().val(result);
      };

      $faceamount.off("blur").on("blur", cal);

      const $load = $(`#load`);
      $load.off("click").on("click", () => {
        const $result = $(`[name="result"]`);
        $result.val("");
        $result.css("background-color", "");

        $faceamount.each((_, row) => {
          $(row).val(parseInt(Math.random() * 100));
          $(row).blur();
        });
      });
    });
  </script>
</html>
